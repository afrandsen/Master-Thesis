```{r setup, include=FALSE}
library(tidyverse)
if (knitr::is_html_output()) {
  options(knitr.table.format = "html")
} else {
  options(knitr.table.format = "latex") 
}
```

```{r setup-plots, include=FALSE}
if (knitr::is_html_output()) {
  knitr::opts_chunk$set(out.width = '100%') 
} else {
  knitr::opts_chunk$set(out.width = '100%')
}
```

\part{Den empiriske analyse}

# Data beskrivelse

# Prædiktabilitet

# Underlæggende model

# Allokering af aktiver

# Diskussion

# Konklusion

```{r script1, code = readLines("C:/Users/AKF/Documents/Matematik-Okonomi/5. Ar/2. Semester/Master-Thesis/Scripts/Speciale.R"), include=FALSE, cache=TRUE}
```

## Problemer ved estimation

Middelværdi-varians optimering har vist sig meget sensitiv overfor den kvantitative størrelse af parametrene som indgår i vægtelsesberegningen for den relevante portefølje, dvs. forventede afkast, varianser, kovarianser. Som også er tilfældet i denne afhandling, er disse parametre estimeret via en tidsserie af afkast, men forventningen til disse estimater skal anskues skeptisk, i det de indeholder en væsentlig mængde usikkerhed.

Simuleringsforsøg har vist at porteføljer udvalgt på baggrund af Markowitz teorien med estimerede input har værre performance og er mindre efficient end en $\tfrac{1}{n}$ (ligevægtet) portefølje, [@Frankfurter1971]. Ligeledes viser [@Chopra1993] at det er afgørende i en porteføljeanalyse at estimere forventede afkast præcist, men forventede afkast er alt andet lige svært prædiktable, [@Merton1980]. Videnskabelige artikler har foreslået ændringer til de statistiske metoder som ligger bag estimaterne, heriblandt foreslår [@Jorion1986] at benytte en Bayesian estimator i stedet for det aritmetiske gennemsnit, se evt. også [@MacKinlay2000; @Garlappi2007; @Kan2007; @Tu2011].

I det følgende, vil vi lave et illustrativt simuleringseksempel, hvor vi tager udgangspunkt i tre risikobærende aktiver, hvis kvartalvise afkast alle er normalfordelt med de første to momenter som set i Tabel \@ref(tab:true). Afkastene er identisk fordelte i alle kvartaler. Det årlige forventede afkast er hhv. $9\%$, $15.76\%$ og $5.12\%$. Standardafvigelsen er hhv. $20.694\%$, $25.794\%$ og $17.320\%$. Vi antager der er ens positiv korrelation mellem hvert aktiv, på $0.5$. Derudover står investoren overfor et risikofrit aktiv med et kvartalvist afkast på $0.125\%$, og dermed et årligt risikofrit afkast på $0.5\%$. Disse er de korrekte parameterværdier, som givetvis er skjult information for investoren til en hvis grad. Investoren skal dermed estimere værdierne fra en tidsserie af observationer trukket fra den korrekte fordeling. Tre tidsserier af afkastsobservationer er blevet simuleret fra den fælles fordeling. Hver observation er hhv. beregnet som
\begin{align}
r_1 &= \mu_1 + \sigma_1\varepsilon_1\\
r_2 &= \mu_2 + \sigma_2\left(\rho_{1,2}\varepsilon_1 + \sqrt{1-\rho_{1,2}^2}\varepsilon_2\right)\\
r_3 &= \mu_3 + \sigma_3 \left( \rho_{1,3} \varepsilon_1+ \frac{ \rho_{2,3}-\rho_{1,2}\rho_{1,3} }{\sqrt{1-\rho_{1,2}^2}}\varepsilon_2+\sqrt{1-\rho_{1,3}^2 -\frac{\left(\rho_{2,3}-\rho_{1,2}\rho_{1,3}\right)^2}{1-\rho_{1,2}^2}}\varepsilon_3\right),
\end{align}

hvor $\varepsilon_i\sim N(0,1)$, for $i=1,2,3$. 

```{r sim-tids, echo=FALSE, fig.align='center', fig.cap='i) Aktiv 1, ii) Aktiv 2, iii) Aktiv 3.', fig.width=18, fig.height=15, fig.pos='htbp!'}
par(mfrow=c(3,1))

plot(data_1[, 1],
     type = 'l',
     xaxs = "i",
     yaxs = "i",
     xlab = 'Kvartal',
     ylab = 'Afkast',
     main = 'i) Aktiv 1')

abline(h = mu_a, col = 'red', lty = 'dotted')
abline(h = mean(data_1[, 1]), col = 'magenta', lty = 'dashed')

plot(data_1[, 2],
     type = 'l',
     xaxs = "i",
     yaxs = "i",
     xlab = 'Kvartal',
     ylab = 'Afkast',
     main = 'ii) Aktiv 2')

abline(h = mu_b, col = 'red', lty = 'dotted')
abline(h = mean(data_1[, 3]), col = 'magenta', lty = 'dashed')

plot(data_1[, 3],
     type = 'l',
     xaxs = "i",
     yaxs = "i",
     xlab = 'Kvartal',
     ylab = 'Afkast',
     main = 'iii) Aktiv 3')

abline(h = mu_c, col = 'red', lty = 'dotted')
abline(h = mean(data_1[, 2]), col = 'magenta', lty = 'dashed')
```


```{r sim-hist, echo=FALSE, fig.align='center', fig.cap='i) Aktiv 1, ii) Aktiv 2, iii) Aktiv 3.', fig.width=18, fig.height=15, fig.pos='htbp!'}
# hist(data_1[, 1], probability = TRUE)

```


Hver tidsserie er baseret på $200$ observationer, svarende til en 50-årig periode med kvartalvise observationer. For hver tidsserie er de første to momenter estimeret ud fra de gængse statistiske metoder

```{r true, echo=FALSE}
data <- round(data.frame(Expect = return*100, Std = std*100, Corr = corr), digits = 3)
rownames(data) <- c('Aktiv 1', 'Aktiv 2', 'Aktiv 3')


data %>% 
  knitr::kable(caption = 'Gengivelse af de sande afkast.',
               booktabs=TRUE,
               align = c('r', 'r', 'r' ,'r', 'r'),
               row.names = T,
               col.names = NULL,
               linesep = "") %>% 
   kableExtra::kable_styling(bootstrap_options = "striped",
                             latex_options = c("striped", "hold_position"),
                             full_width = F) %>% 
  kableExtra::add_header_above(c(" ", "Forv. afkast" = 1, "Volatilitet" = 1, "Korrelationer" = 3))
```

```{r sim1, echo=FALSE}

data_1 <- round(data.frame(Expect = data_1_mean*100, Std = data_1_sd*100, Corr = data_1_cor), digits = 3)

rownames(data_1) <- c('Aktiv 1', 'Aktiv 2', 'Aktiv 3')

data_1 %>% 
  knitr::kable(caption = 'Gengivelse af første simulation af afkast.',
               booktabs=TRUE,
               align = c('r','r', 'r' ,'r', 'r'),
               row.names = T,
               col.names = NULL,
               linesep = "") %>% 
   kableExtra::kable_styling(bootstrap_options = "striped",
                             latex_options = c("striped", "hold_position"),
                             full_width = F) %>% 
  kableExtra::add_header_above(c(" ", "Forv. afkast" = 1, "Volatilitet" = 1, "Korrelationer" = 3))

```

```{r sim2, echo=FALSE}
data_2 <- round(data.frame(Expect = data_2_mean*100, Std = data_2_sd*100, Corr = data_2_cor), digits = 3)

rownames(data_2) <- c('Aktiv 1', 'Aktiv 2', 'Aktiv 3')

data_2 %>% 
  knitr::kable(caption = 'Gengivelse af anden simulation af afkast.',
               booktabs=TRUE,
               align = c('r','r', 'r' ,'r', 'r'),
               row.names = T,
               col.names = NULL,
               linesep = "") %>% 
   kableExtra::kable_styling(bootstrap_options = "striped",
                             latex_options = c("striped", "hold_position"),
                             full_width = F) %>% 
  kableExtra::add_header_above(c(" ", "Forv. afkast" = 1, "Volatilitet" = 1, "Korrelationer" = 3))
```

```{r sim3, echo=FALSE}
data_3 <- round(data.frame(Expect = data_3_mean*100, Std = data_3_sd*100, Corr = data_3_cor), digits = 3)

rownames(data_3) <- c('Aktiv 1', 'Aktiv 2', 'Aktiv 3')

data_3 %>% 
  knitr::kable(caption = 'Gengivelse af tredje simulation af afkast.',
               booktabs=TRUE,
               align = c('r','r', 'r' ,'r', 'r'),
               row.names = T,
               col.names = NULL,
               linesep = "") %>% 
   kableExtra::kable_styling(bootstrap_options = "striped",
                             latex_options = c("striped", "hold_position"),
                             full_width = F) %>% 
  kableExtra::add_header_above(c(" ", "Forv. afkast" = 1, "Volatilitet" = 1, "Korrelationer" = 3))

```


Disse tre sæt af estimerede parametre baseret på de tre tidsserier er blevet udvalgt til følgende illustrative formål. Se Tabel \@ref(tab:sim1), Tabel \@ref(tab:sim2) og Tabel \@ref(tab:sim3) for en sammenligning ift. de sande parametre. Ud fra de sande parametre samt de estimerede parametre fra de tre tidsserier er global minimum varians porteføljen, tangensporteføljen, den optimale portefølje for en *CRRA* investor med risikoaversions parameter lig hhv. $1$, $5$ og $10$, samt den optimale portefølje for en *CARA* investor med risikoaversions parameter lig hhv. $1$, $5$ og $10$.

Porteføljen for *CARA*-investoren er beregnet som
$$w^*=\frac{\mu_{\text{tan}}-r_0}{(aW_0)\sigma_{\text{tan}}^2},$$

hvor $w^*$ er den del af formuen som investoren skal investere i tangensporteføljen. Det estimerede forventede afkast, $\mu_{\text{tan}}$, og variansen af tangensporteføljen, $\sigma_{\text{tan}}^2$, er beregnet via de estimerede momenter af hvert aktiv. Delen som skal investeres i det risikofrie aktiv, bliver beregnet residuerligt som
$$w_{r_0}^*=1-w^*.$$

*CRRA* porteføljen er beregnet som i Sektion ??. Herudover er det sande forventede afkast og den sande standardafvigelse beregnet for hver portefølje, ved brug af de sande momenter introduceret ovenfor.

```{r sum-true, echo=FALSE}
options(knitr.kable.NA = '')
data <- round(data.frame(Min = c(port_true$gmv$weights,0,port_true$gmv$er*100, NA, port_true$gmv$sd*100, NA),
                         Tan = c(port_true$tan$weights,0,port_true$tan$er*100, NA, port_true$tan$sd*100, NA),
                         Crra_1 = c(port_true$crra_1$weights, port_true$crra_1$er*100, NA, port_true$crra_1$sd*100, NA),
                         Crra_4 = c(port_true$crra_4$weights, port_true$crra_4$er*100, NA, port_true$crra_4$sd*100, NA),
                         Crra_8 = c(port_true$crra_8$weights, port_true$crra_8$er*100, NA, port_true$crra_8$sd*100, NA),
                         cara_1 = c(port_true$cara_1$weights, port_true$cara_1$er*100, NA, port_true$cara_1$sd*100, NA),
                         cara_4 = c(port_true$cara_4$weights, port_true$cara_4$er*100, NA, port_true$cara_4$sd*100, NA),
                         cara_8 = c(port_true$cara_8$weights, port_true$cara_8$er*100, NA, port_true$cara_8$sd*100, NA)), digits = 3)

rownames(data) <- c('Aktiv 1', 'Aktiv 2', 'Aktiv 3', 'Risikofri', 'Forv. Afkast', 'Estimeret afkast', 'Volatilitet', 'Estimeret volatilitet')
colnames(data) <- c(" "," ","$\\gamma=1$", "$\\gamma=4$", "$\\gamma=8$", "$a=1$", "$a=4$", "$a=8$")

data %>% 
  knitr::kable(caption = 'Gengivelse af de beregnede porteføljer ved brug af de sande afkast.',
               booktabs=TRUE,
               align = c('r', 'r', 'r' ,'r', 'r'),
               row.names = T,
               escape = FALSE,
               #col.names = NULL,
               linesep = "") %>% 
   kableExtra::kable_styling(bootstrap_options = "striped",
                             latex_options = c("striped", "hold_position"),
                             full_width = F) %>% 
  kableExtra::add_header_above(c(" ", "GMV" = 1, "Tangens" = 1, "CRRA" = 3, "CARA" = 3), escape = F) %>% 
  kableExtra::row_spec(c(6, 8), italic = T)
```

```{r sum-1, echo=FALSE}
options(knitr.kable.NA = '')
data <- round(data.frame(Min = c(port_1$gmv$weights,
                                 0,
                                 sum(port_1$gmv$weights*return)*100,
                                 port_1$gmv$er*100,
                                 sqrt(t(port_1$gmv$weights) %*% cov %*% port_1$gmv$weights)*100,
                                 port_1$gmv$sd*100),
                         Tan = c(port_1$tan$weights,
                                 0,
                                 sum(port_1$tan$weights*return)*100,
                                 port_1$tan$er*100,
                                 sqrt(t(port_1$tan$weights) %*% cov %*% port_1$tan$weights)*100,
                                 port_1$tan$sd*100),
                         Crra_1 = c(port_1$crra_1$weights,
                                 sum(port_1$crra_1$weights*c(return, rf))*100,
                                 port_1$crra_1$er*100,
                                 sqrt(t(port_1$crra_1$weights[1:3]) %*% cov %*% port_1$crra_1$weights[1:3])*100,
                                 port_1$crra_1$sd*100),
                         Crra_4 = c(port_1$crra_4$weights,
                                 sum(port_1$crra_4$weights*c(return, rf))*100,
                                 port_1$crra_4$er*100,
                                 sqrt(t(port_1$crra_4$weights[1:3]) %*% cov %*% port_1$crra_4$weights[1:3])*100,
                                 port_1$crra_4$sd*100),
                         Crra_8 = c(port_1$crra_8$weights,
                                 sum(port_1$crra_8$weights*c(return, rf))*100,
                                 port_1$crra_8$er*100,
                                 sqrt(t(port_1$crra_8$weights[1:3]) %*% cov %*% port_1$crra_8$weights[1:3])*100,
                                 port_1$crra_8$sd*100),
                         cara_1 = c(port_1$cara_1$weights,
                                 sum(port_1$cara_1$weights*c(return, rf))*100,
                                 port_1$cara_1$er*100,
                                 sqrt(t(port_1$cara_1$weights[1:3]) %*% cov %*% port_1$cara_1$weights[1:3])*100,
                                 port_1$cara_1$sd*100),
                         cara_4 = c(port_1$cara_4$weights,
                                 sum(port_1$cara_4$weights*c(return, rf))*100,
                                 port_1$cara_4$er*100,
                                 sqrt(t(port_1$cara_4$weights[1:3]) %*% cov %*% port_1$cara_4$weights[1:3])*100,
                                 port_1$cara_4$sd*100),
                         cara_8 = c(port_1$cara_8$weights,
                                 sum(port_1$cara_8$weights*c(return, rf))*100,
                                 port_1$cara_8$er*100,
                                 sqrt(t(port_1$cara_8$weights[1:3]) %*% cov %*% port_1$cara_8$weights[1:3])*100,
                                 port_1$cara_8$sd*100)), digits = 3)

rownames(data) <- c('Aktiv 1', 'Aktiv 2', 'Aktiv 3', 'Risikofri', 'Forv. Afkast', 'Estimeret afkast', 'Volatilitet', 'Estimeret volatilitet')
colnames(data) <- c(" "," ","$\\gamma=1$", "$\\gamma=4$", "$\\gamma=8$", "$a=1$", "$a=4$", "$a=8$")

data %>% 
  knitr::kable(caption = 'Gengivelse af de beregnede porteføljer ved brug af de simulerede afkast, fra første simulering.',
               booktabs=TRUE,
               align = c('r', 'r', 'r' ,'r', 'r'),
               row.names = T,
               escape = FALSE,
               #col.names = NULL,
               linesep = "") %>% 
   kableExtra::kable_styling(bootstrap_options = "striped",
                             latex_options = c("striped", "hold_position"),
                             full_width = F) %>% 
  kableExtra::add_header_above(c(" ", "GMV" = 1, "Tangens" = 1, "CRRA" = 3, "CARA" = 3), escape = F) %>% 
  kableExtra::row_spec(c(6, 8), italic = T)
```

```{r sum-2, echo=FALSE}
options(knitr.kable.NA = '')
data <- round(data.frame(Min = c(port_2$gmv$weights,
                                 0,
                                 sum(port_2$gmv$weights*return)*100,
                                 port_2$gmv$er*100,
                                 sqrt(t(port_2$gmv$weights) %*% cov %*% port_2$gmv$weights)*100,
                                 port_2$gmv$sd*100),
                         Tan = c(port_2$tan$weights,
                                 0,
                                 sum(port_2$tan$weights*return)*100,
                                 port_2$tan$er*100,
                                 sqrt(t(port_2$tan$weights) %*% cov %*% port_2$tan$weights)*100,
                                 port_2$tan$sd*100),
                         Crra_1 = c(port_2$crra_1$weights,
                                 sum(port_2$crra_1$weights*c(return, rf))*100,
                                 port_2$crra_1$er*100,
                                 sqrt(t(port_2$crra_1$weights[1:3]) %*% cov %*% port_2$crra_1$weights[1:3])*100,
                                 port_2$crra_1$sd*100),
                         Crra_4 = c(port_2$crra_4$weights,
                                 sum(port_2$crra_4$weights*c(return, rf))*100,
                                 port_2$crra_4$er*100,
                                 sqrt(t(port_2$crra_4$weights[1:3]) %*% cov %*% port_2$crra_4$weights[1:3])*100,
                                 port_2$crra_4$sd*100),
                         Crra_8 = c(port_2$crra_8$weights,
                                 sum(port_2$crra_8$weights*c(return, rf))*100,
                                 port_2$crra_8$er*100,
                                 sqrt(t(port_2$crra_8$weights[1:3]) %*% cov %*% port_2$crra_8$weights[1:3])*100,
                                 port_2$crra_8$sd*100),
                         cara_1 = c(port_2$cara_1$weights,
                                 sum(port_2$cara_1$weights*c(return, rf))*100,
                                 port_2$cara_1$er*100,
                                 sqrt(t(port_2$cara_1$weights[1:3]) %*% cov %*% port_2$cara_1$weights[1:3])*100,
                                 port_2$cara_1$sd*100),
                         cara_4 = c(port_2$cara_4$weights,
                                 sum(port_2$cara_4$weights*c(return, rf))*100,
                                 port_2$cara_4$er*100,
                                 sqrt(t(port_2$cara_4$weights[1:3]) %*% cov %*% port_2$cara_4$weights[1:3])*100,
                                 port_2$cara_4$sd*100),
                         cara_8 = c(port_2$cara_8$weights,
                                 sum(port_2$cara_8$weights*c(return, rf))*100,
                                 port_2$cara_8$er*100,
                                 sqrt(t(port_2$cara_8$weights[1:3]) %*% cov %*% port_2$cara_8$weights[1:3])*100,
                                 port_2$cara_8$sd*100)), digits = 3)

rownames(data) <- c('Aktiv 1', 'Aktiv 2', 'Aktiv 3', 'Risikofri', 'Forv. Afkast', 'Estimeret afkast', 'Volatilitet', 'Estimeret volatilitet')
colnames(data) <- c(" "," ","$\\gamma=1$", "$\\gamma=4$", "$\\gamma=8$", "$a=1$", "$a=4$", "$a=8$")

data %>% 
  knitr::kable(caption = 'Gengivelse af de beregnede porteføljer ved brug af de simulerede afkast, fra anden simulering.',
               booktabs=TRUE,
               align = c('r', 'r', 'r' ,'r', 'r'),
               row.names = T,
               escape = FALSE,
               #col.names = NULL,
               linesep = "") %>% 
   kableExtra::kable_styling(bootstrap_options = "striped",
                             latex_options = c("striped", "hold_position"),
                             full_width = F) %>% 
  kableExtra::add_header_above(c(" ", "GMV" = 1, "Tangens" = 1, "CRRA" = 3, "CARA" = 3), escape = F) %>% 
  kableExtra::row_spec(c(6, 8), italic = T)
```

```{r sum-3, echo=FALSE}
options(knitr.kable.NA = '')
data <- round(data.frame(Min = c(port_3$gmv$weights,
                                 0,
                                 sum(port_3$gmv$weights*return)*100,
                                 port_3$gmv$er*100,
                                 sqrt(t(port_3$gmv$weights) %*% cov %*% port_3$gmv$weights)*100,
                                 port_3$gmv$sd*100),
                         Tan = c(port_3$tan$weights,
                                 0,
                                 sum(port_3$tan$weights*return)*100,
                                 port_3$tan$er*100,
                                 sqrt(t(port_3$tan$weights) %*% cov %*% port_3$tan$weights)*100,
                                 port_3$tan$sd*100),
                         Crra_1 = c(port_3$crra_1$weights,
                                 sum(port_3$crra_1$weights*c(return, rf))*100,
                                 port_3$crra_1$er*100,
                                 sqrt(t(port_3$crra_1$weights[1:3]) %*% cov %*% port_3$crra_1$weights[1:3])*100,
                                 port_3$crra_1$sd*100),
                         Crra_4 = c(port_3$crra_4$weights,
                                 sum(port_3$crra_4$weights*c(return, rf))*100,
                                 port_3$crra_4$er*100,
                                 sqrt(t(port_3$crra_4$weights[1:3]) %*% cov %*% port_3$crra_4$weights[1:3])*100,
                                 port_3$crra_4$sd*100),
                         Crra_8 = c(port_3$crra_8$weights,
                                 sum(port_3$crra_8$weights*c(return, rf))*100,
                                 port_3$crra_8$er*100,
                                 sqrt(t(port_3$crra_8$weights[1:3]) %*% cov %*% port_3$crra_8$weights[1:3])*100,
                                 port_3$crra_8$sd*100),
                         cara_1 = c(port_3$cara_1$weights,
                                 sum(port_3$cara_1$weights*c(return, rf))*100,
                                 port_3$cara_1$er*100,
                                 sqrt(t(port_3$cara_1$weights[1:3]) %*% cov %*% port_3$cara_1$weights[1:3])*100,
                                 port_3$cara_1$sd*100),
                         cara_4 = c(port_3$cara_4$weights,
                                 sum(port_3$cara_4$weights*c(return, rf))*100,
                                 port_3$cara_4$er*100,
                                 sqrt(t(port_3$cara_4$weights[1:3]) %*% cov %*% port_3$cara_4$weights[1:3])*100,
                                 port_3$cara_4$sd*100),
                         cara_8 = c(port_3$cara_8$weights,
                                 sum(port_3$cara_8$weights*c(return, rf))*100,
                                 port_3$cara_8$er*100,
                                 sqrt(t(port_3$cara_8$weights[1:3]) %*% cov %*% port_3$cara_8$weights[1:3])*100,
                                 port_3$cara_8$sd*100)), digits = 3)

rownames(data) <- c('Aktiv 1', 'Aktiv 2', 'Aktiv 3', 'Risikofri', 'Forv. Afkast', 'Estimeret afkast', 'Volatilitet', 'Estimeret volatilitet')
colnames(data) <- c(" "," ","$\\gamma=1$", "$\\gamma=4$", "$\\gamma=8$", "$a=1$", "$a=4$", "$a=8$")

data %>% 
  knitr::kable(caption = 'Gengivelse af de beregnede porteføljer ved brug af de simulerede afkast, fra tredje simulering.',
               booktabs=TRUE,
               align = c('r', 'r', 'r' ,'r', 'r'),
               row.names = T,
               escape = FALSE,
               #col.names = NULL,
               linesep = "") %>% 
   kableExtra::kable_styling(bootstrap_options = "striped",
                             latex_options = c("striped", "hold_position"),
                             full_width = F) %>% 
  kableExtra::add_header_above(c(" ", "GMV" = 1, "Tangens" = 1, "CRRA" = 3, "CARA" = 3), escape = F) %>% 
  kableExtra::row_spec(c(6, 8), italic = T)
```

```{r weight-exp, echo=FALSE, fig.align='center', fig.cap='Global minimum varians portføljen, tangensporteføljen samt for CRRA- og CARA-porteføljen for hhv. $a=1$, $a=4$ og $a=8$, beregnet ud for hhv. de sande og simulerede afkast.', fig.pos='htbp!', fig.width=18, fig.asp=0.4}
par(mfrow=c(1,1))
plot(sort(sd),
     sort(r),
     type ='l',
     xlim=c(0,max(c(sd, sd_1, sd_2, sd_3))+0.01),
     ylim=c(0,max(c(r, r_1, r_2, r_3))+0.01),
     xaxs = "i",
     yaxs = "i",
     xlab = 'Volatilitet',
     ylab = 'Forventet afkast',
     main = 'Porteføljer.'
     )
points(sort(sd), sort(r))
lines(sort(sd_3), sort(r_3), col='red')
points(sort(sd_3), sort(r_3), col='red')
lines(sort(sd_2), sort(r_2), col='magenta')
points(sort(sd_2), sort(r_2), col='magenta')
lines(sort(sd_1), sort(r_1), col='blue')
points(sort(sd_1), sort(r_1), col='blue')
```


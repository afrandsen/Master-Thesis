```{r setup, include=FALSE}
library(tidyverse)
library(quantmod)
library(kableExtra)
if (knitr::is_html_output()) {
  options(knitr.table.format = "html")
} else {
  options(knitr.table.format = "latex") 
}
```

```{r setup-plots, include=FALSE}
if (knitr::is_html_output()) {
  knitr::opts_chunk$set(out.width = '100%') 
} else {
  knitr::opts_chunk$set(out.width = '100%')
}
```

\part{Den empiriske analyse}

```{r script1, code = readLines("C:/Users/AKF/Documents/Matematik-Okonomi/5. Ar/2. Semester/Master-Thesis/Input/Script.R"), include=FALSE, cache=TRUE}
```

# Data beskrivelse
Dette kapitel har til formål at give en uddybende beskrivelse af det anvendte data -- mht. både aktivklasser og forklarende variable -- til den empiriske analyse. Alle variable består af kvartalsvise observationer over tidsperioden 1954 1. kvartal, hvor rente fik lov at variere frit blablabla, til 2018 4. kvartal grundet dataophør. Variablene er vist i niveauer. Kapitlet er organiseret som følger. Sektion ?? beskriver detaljeret hver aktivklasse og dets tilhørende beskrivende statistik. Sektion ?? indeholder en tilsvarende beskrivelse af de tilhørende tilstandsvariable. Korrelationen mellem aktivklasserne og tilstandsvariablene undersøges i Sektion ??. Sektion ?? giver en opsummering af kapitlets statistiske fund.

## Beskrivelse af aktivklasser
Mængden af aktivklasser, som pt. er tilgængelige på finansmarkedet har aldrig været større. Udover aktier og obligationer, findes et væld af eksponeringsområder og/eller finansielle produkter heriblandt ejendom, derivater, futures, forwards, kryptovaluta, valuta mm. For at holde denne analyse på et simpelt niveau medtages de mest anvendte aktivklasser for institutionelle og private investorer. Hvilket også er de mest anvendte i eksisterende litteratur, [@CampVic2003; @CampVic1999], [@JurVic2011], [@Engsted2012], [@CampVicCha2003]. I det følgende vil egenskaberne for aktivklasserne: risikofri afkast, merafkast på aktier, merafkast på statsobligationer og merafkast på virksomhedsobligationer beskrives og derudover vil den tilhørende beskrivende statistik for hvert aktiv belyses.

### Det risikofrie afkast -- $r_{t+1}^{\textnormal{rf}}$
Essencen af et risikofrit aktiv er at repræsentere et afkast med varians lig $0$. Dette betegnes undertiden også som et sikkert afkast. Udover at give investoren muligheder for indlån, kan investoren også udvide sine investeringsmuligheder ved at låne til den risikofrie rente, dvs. have en kort position i det risikofrie aktiv. Et ofte valgt aktiv i litteraturen, som en proxy for det risikofrie aktiv, er de kortefristede statsværdipapirer, [@CampVic2003; @CampVic1999], [@JurVic2011], [@Engsted2012], [@CampVicCha2003]. Disse betegnes i U.S.A. som *T-Bills*. Valget af netop dette aktiv sker på baggrund af den historiske og nuværende meget lave risiko for statskonkurser, [@Beers2017]. Eksempelvis gik den danske stat tilnærmelsesvis senest bankerot under *Statsbankerotten* i 1813 efter *Napoleonskrigene*. Derfor benyttes det amerikanske statspapir med kort løbetid, mere præcist anvendes den 90-dages amerikanske *T-Bill*, som en proxy for det risikofrie aktiv. Data over afkast er fra [@CRSPt90] hentet gennem [@WRDSt90]. Log netto afkastet af det risikofrie afkast beregnes som log forskellen mellem det kvartalsvise brutto afkast på den amerikanske 90-dages *T-Bill* og den kvartalsvise inflationsrate, målt via *CPI*. Nettoafkastet har et kvartalsvist justeret afkast på `r round(DESCRIPTIVE$adj_mean[1]*100, 1)`$\%$ med en kvartalsvis volatilitet på `r round(DESCRIPTIVE$sd[1]*100, 1)`$\%$. Som det kan ses på kvantilerne har det risikofrie afkast givet negativt afkast sommetider. Et histogram indikerer en højreskæv fordeling af afkast, hvilket også underbygges af en skævhed på `r round(DESCRIPTIVE$skew[1], 3)`. Med en kurtosis på `r round(DESCRIPTIVE$kurt[1], 3)` haves en leptokurtisk fordeling, med tykkere/længere haler og et smallere samt højere cetrum.

### Merafkastet på aktier -- $r_{t+1}^{\textnormal{a}}$
For aktivklassen, som skal repræsentere børshandlede aktier, benyttes et markedsværdi-vægtet afkast over et repræsentativt indeks for samtlige handlede aktier på *New York Stock Exchange*, *National Association of Securities Dealers Automated Quotations* og *American Stock Exchange*. Det vægtede afkast er inklusiv dividender, aktiesplits og ny emissioner for de foregående 12 måneder ledende op til kvartalet. Ved at benytte et sådant forholdsvist bredt indeks, vil delanalysen for aktier være repræsentativt for det globale aktiemarked. Derudover er det ikke kun børsnoterede ameriansk baserede selskaber, som handles via *NYSE*, *NASDAQ* og *AMEX*, men i stadig større grad også virksomheder uden for U.S.A. Data over afkast er fra [@CRSPakt] og hentet gennem [@WRDSakt]. Log netto merafkastet af aktier beregnes som det kvartalsvise log brutto aktieafkastet fratrukket det kvartalsvise brutto afkast på den amerikanske 90-dages *T-Bill*. Det ses at aktier har det klart højeste kvartalvise justerede merafkast på `r round(DESCRIPTIVE$adj_mean[2]*100, 1)`$\%$ ift. de andre aktivklasser. Dette høje merafkast følges af en ligeledes høj relativ volatilitet på `r round(DESCRIPTIVE$sd[2]*100, 1)`$\%$. Historisk set har det største negativ markedsudsving givet et merafkast/tab på $-30.4\%$, mens det største positive markedsudsving har været på $20\%$. Et histogram sammenholdt med en skævhed på `r round(DESCRIPTIVE$skew[2], 3)` afslører moderat til høj venstreskævhed. Altså har der oftere været negative merafkast ift. positive. Kurtosis på `r round(DESCRIPTIVE$kurt[2], 3)` medører en moderat leptokurtisk fordeling med en anelse tykkere haler, og at ekstreme observationer sker oftere end normalt.

### Merafkastet på statsobligationer -- $r_{t+1}^{\textnormal{s}}$
Statsobligationer er gældsinstrumenter udstedet af staten i det respektive udstedelsesland, de har til formål at finansiere offentlige udgifter og anses også for at være en substitution for skatter. Siden udstedelsen sker af staten, antages det ofte, at statsobligationer er relativt mindre risikobærende and aktier. Undertiden betegnes statsobligationer fra visse ilande som et *safe haven* for investorer. Eksempelvis har den danske stat pt. en kreditvurdering på AAA, Aaa, AAA af hhv. *Standard \& Poor's*, *Moody's* og *Fitch*., [@TradingEconomics]. Til formålet at repræsentere afkastet på statsobligationer anvendes derfor den 10-årige amerikanske statsobligation med konstant løbetid. Data over afkast er fra [@CRSPt90] og hentet gennem [@WRDSt90]. Log netto merafkastet af statsobligationener beregnes som det kvartalsvise log brutto afkast fratrukket det kvartalsvise brutto afkast på den amerikanske 90-dages *T-Bill*. Netto merafkastet har et justeret kvartalsvist afkast på `r round(DESCRIPTIVE$adj_mean[3]*100, 1)`$\%$ med en kvartalsvis volatilitet på `r round(DESCRIPTIVE$sd[3]*100, 1)`$\%$. Statsobligationen har den laveste *Sharpe Ratio* af de tre aktivklasser, hvilket også er forventeligt. Med en skævhed på `r round(DESCRIPTIVE$skew[3], 3)` og kurtosis på `r round(DESCRIPTIVE$kurt[3], 3)` haves en forholdsvis symmetrisk fordeling, men med en anelse tykkere haler.

### Merafkastet på virksomhedsobligationer -- $r_{t+1}^{\textnormal{v}}$
På samme vis som stater kan finansiere deres aktiviteter via statsobligationer, kan virksomheder udstede gæld via obligationer, vis formål er at finansiere fremtidige investeringer og/eller projekter. Sikkerheden bag en virksomhedsobligation afhænger af virksomhedens betalingsevne. Af og til sætter virksomheden fysiske aktiver som kollateral for obligationerne i tilfælde af konkurser. Ift. statsobligationer bærer virksomhedsobligationer på en langt større risiko givet kreditrisikoen i virksomheden og/eller markedet. For at påtage sig denne risiko, forlanger investorerne derfor en højere præmie i form af en højere rente tilhørende virksomhedsobligationerne. For at repræsentere virksomhedsobligationer anvendes en indeksserie af virksomhedsobligationer med lang løbetid. Data er fra [@Ibbotson2019] og hentet via [@Goyal2007]. Det specifikke grundlag for tidsserien er tvetydigt, men [@Ibbotson2019] skriver følgende.
\begin{center}
\textit{A corporate bond series with a long maturity is used to describe fixed-income securities that contain risk of default.}
\end{center}
Log netto merafkastet af virksomhedsobligationenerne beregnes som det kvartalsvise log brutto afkast fratrukket det kvartalsvise brutto afkast på den amerikanske 90-dages *T-Bill*. Som forventet ses den højere afkastpræmie med et justeret kvartalsvist afkast på `r round(DESCRIPTIVE$adj_mean[4]*100, 1)`$\%$ og en tilhørende volatilitet på `r round(DESCRIPTIVE$sd[4]*100, 1)`$\%$, som investoren får, for at påtage sig den ekstra kreditrisiko. Afkastfordelingen anses som værende relativt mest symmetrisk ift. de andre aktivklasser, hvilket også ses i en skævhedsværdi på `r round(DESCRIPTIVE$skew[4], 3)`. Med en kurtosis på mere end $3$, har fordelingen tykkere haler og med mere masse centralt i fordelingen. Det bemærkes ligeledes at virksomhedsobligationer har haft de største positive markedsudsving af de tre aktivklasser med et positivt afkast på $20.8 \%$.

Tabel \@ref(tab:DES-AKTIVKLASSE) opsummere ovenstående beskrivende statistik for de tre aktivkasser og derudover for det kvartalsvise brutto afkast på den amerikanske 90-dages *T-Bill*, undertiden også betegnet som det nominelle afkast.

\begin{landscape}
```{r DES-AKTIVKLASSE, echo=FALSE}
options(knitr.kable.NA = '')
DESCRIPTIVE <- format(round(DESCRIPTIVE, digits = 3), nsmall = 3)
DESCRIPTIVE$sr[1] <- NA

colnames(DESCRIPTIVE) <- c('Middelværdi', 'Standard afvigelse', 'Sharpe Ratio', 'Skævhed', 'Kurtosis', 'Minimum', '$25 \\%$', 'Median', '$75 \\%$', 'Maksimum')

rownames(DESCRIPTIVE) <- c("$r_t^{\\text{rf}}$", "$r_t^{\\text{a}}$", "$r_t^{\\text{s}}$", "$r_t^{\\text{v}}$")

DESCRIPTIVE %>% 
  knitr::kable(caption = 'G',
               booktabs=TRUE,
               align = c(rep('r', 10)),
               row.names = TRUE,
               escape = FALSE,
               #col.names = NULL,
               linesep = "") %>% 
   kableExtra::kable_styling(bootstrap_options = "striped",
                             latex_options = c("striped", "hold_position"),
                             full_width = F)
```

```{r DES-TILSTANDSVARIABLE, echo=FALSE}
DESCRIPTIVE_T <- format(round(DESCRIPTIVE_T, digits = 3), nsmall = 3)

colnames(DESCRIPTIVE_T) <- c('Middelværdi', 'Standard afvigelse', 'Skævhed', 'Kurtosis', 'Minimum', '$25 \\%$', 'Median', '$75 \\%$', 'Maksimum')

rownames(DESCRIPTIVE_T) <- c('$x_t^{\\text{b}}$', '$x_t^{\\text{pe}}$', '$x_t^{\\text{dp}}$', '$x_t^{\\text{bm}}$', '$x_t^{\\sigma_{\\text{a}}^2}$', '$x_t^{\\text{ts}}$', '$x_t^{\\text{ys}}$', '$x_t^{\\text{cs}}$', '$x_t^{\\text{ds}}$', '$x_t^{\\text{fr}}$', '$x_t^{\\text{hml}}$', '$x_t^{\\text{smb}}$')

DESCRIPTIVE_T %>% 
  knitr::kable(caption = 'G',
               booktabs=TRUE,
               align = c(rep('r', 9)),
               row.names = TRUE,
               escape = FALSE,
               #col.names = NULL,
               linesep = "") %>% 
   kableExtra::kable_styling(bootstrap_options = "striped",
                             latex_options = c("striped", "hold_position"),
                             full_width = F)
```

```{r DES-KOR, echo=FALSE}
DES_COR <- format(round(cor(data), digits = 2), nsmall = 2)
DES_COR[lower.tri(DES_COR)] <- NA

colnames(DES_COR) <- c("$r_t^{\\text{rf}}$", "$r_t^{\\text{a}}$", "$r_t^{\\text{s}}$", "$r_t^{\\text{v}}$", '$x_t^{\\text{b}}$', '$x_t^{\\text{pe}}$', '$x_t^{\\text{dp}}$', '$x_t^{\\text{bm}}$', '$x_t^{\\sigma_{\\text{a}}^2}$', '$x_t^{\\text{ts}}$', '$x_t^{\\text{ys}}$', '$x_t^{\\text{cs}}$', '$x_t^{\\text{ds}}$', '$x_t^{\\text{fr}}$', '$x_t^{\\text{hml}}$', '$x_t^{\\text{smb}}$')

rownames(DES_COR) <- c("$r_t^{\\text{rf}}$", "$r_t^{\\text{a}}$", "$r_t^{\\text{s}}$", "$r_t^{\\text{v}}$", '$x_t^{\\text{b}}$', '$x_t^{\\text{pe}}$', '$x_t^{\\text{dp}}$', '$x_t^{\\text{bm}}$', '$x_t^{\\sigma_{\\text{a}}^2}$', '$x_t^{\\text{ts}}$', '$x_t^{\\text{ys}}$', '$x_t^{\\text{cs}}$', '$x_t^{\\text{ds}}$', '$x_t^{\\text{fr}}$', '$x_t^{\\text{hml}}$', '$x_t^{\\text{smb}}$')

DES_COR %>% 
  knitr::kable(caption = 'G',
               booktabs=TRUE,
               align = c(rep('r', ncol(cor(data)))),
               row.names = TRUE,
               escape = FALSE,
               #col.names = NULL,
               linesep = "") %>% 
   kableExtra::kable_styling(bootstrap_options = "striped",
                             latex_options = c("striped", "hold_position"),
                             full_width = F)
```
\end{landscape}

## Tilstandsvariable

### Nominel rente -- $x_t^{(\text{b})}$

### *Price-Earnings Ratio* -- $x_t^{(\text{PE})}$

### *Dividend-Price Ratio* -- $x_t^{(\text{DP})}$

### *Book-to-Market Ratio* -- $x_t^{(\text{BM})}$

### Aktievarians -- $x_t^{(\sigma_{\text{a}}^2)}$

### *Small-Minus-Big* -- $x_t^{(\text{BM})}$

### *High-Minus-Low* -- $x_t^{(\text{BM})}$

### *Federal Funds Rate* -- $x_t^{(\text{BM})}$

### *Term Spread* -- $x_t^{(\text{TS})}$

### *Yield Spread* -- $x_t^{(\text{YS})}$

### *Credit Spread* -- $x_t^{(\text{CS})}$

### *Default Spread* -- $x_t^{(\text{DS})}$

## Korrelation

## Opsummering

# Prædiktabilitet

```{r UNI, echo=FALSE}
options(knitr.kable.NA = '')

FIT_TABLE <- format(round(FIT_TABLE, digits = 3), nsmall = 3)

FIT_TABLE <- FIT_TABLE %>%
  mutate(coef = cell_spec(coef,"latex", bold = ifelse(p <= 0.05, T, F)))
  
colnames(FIT_TABLE) <- c('Koefficient', 'Standardfejl', '$t$-værdi', '$p$', '$R^2$')

rownames(FIT_TABLE) <- c('$x_t^{\\text{b}}$', '$x_t^{\\text{pe}}$', '$x_t^{\\text{dp}}$', '$x_t^{\\text{bm}}$', '$x_t^{\\sigma_{\\text{a}}^2}$', '$x_t^{\\text{ts}}$', '$x_t^{\\text{ys}}$', '$x_t^{\\text{cs}}$', '$x_t^{\\text{ds}}$', '$x_t^{\\text{fr}}$', '$x_t^{\\text{hml}}$', '$x_t^{\\text{smb}}$')

FIT_S_TABLE <- format(round(FIT_S_TABLE, digits = 3), nsmall = 3)

FIT_S_TABLE <- FIT_S_TABLE %>%
  mutate(coef = cell_spec(coef, "latex", bold = ifelse(p <= 0.05, T, F)))

colnames(FIT_S_TABLE) <- c('Koefficient', 'Standardfejl', '$t$-værdi', '$p$', '$R^2$')

rownames(FIT_S_TABLE) <- c('$x_t^{\\text{b}}$', '$x_t^{\\text{pe}}$', '$x_t^{\\text{dp}}$', '$x_t^{\\text{bm}}$', '$x_t^{\\sigma_{\\text{a}}^2}$', '$x_t^{\\text{ts}}$', '$x_t^{\\text{ys}}$', '$x_t^{\\text{cs}}$', '$x_t^{\\text{ds}}$', '$x_t^{\\text{fr}}$', '$x_t^{\\text{hml}}$', '$x_t^{\\text{smb}}$')

FIT_V_TABLE <- format(round(FIT_V_TABLE, digits = 3), nsmall = 3)

FIT_V_TABLE <- FIT_V_TABLE %>%
  mutate(coef = cell_spec(coef, "latex", bold = ifelse(p <= 0.05, T, F)))

colnames(FIT_V_TABLE) <- c('Koefficient', 'Standardfejl', '$t$-værdi', '$p$', '$R^2$')

rownames(FIT_V_TABLE) <- c('$x_t^{\\text{b}}$', '$x_t^{\\text{pe}}$', '$x_t^{\\text{dp}}$', '$x_t^{\\text{bm}}$', '$x_t^{\\sigma_{\\text{a}}^2}$', '$x_t^{\\text{ts}}$', '$x_t^{\\text{ys}}$', '$x_t^{\\text{cs}}$', '$x_t^{\\text{ds}}$', '$x_t^{\\text{fr}}$', '$x_t^{\\text{hml}}$', '$x_t^{\\text{smb}}$')

FIT_TABLE %>% 
  knitr::kable(caption = 'G',
               booktabs=TRUE,
               align = c(rep('r', 5)),
               row.names = TRUE,
               escape = FALSE,
               #col.names = NULL,
               linesep = "") %>% 
   kableExtra::kable_styling(bootstrap_options = "striped",
                             latex_options = c("striped", "hold_position"),
                             full_width = F)

FIT_S_TABLE %>% 
  knitr::kable(caption = 'G',
               booktabs=TRUE,
               align = c(rep('r', 5)),
               row.names = TRUE,
               escape = FALSE,
               #col.names = NULL,
               linesep = "") %>% 
   kableExtra::kable_styling(bootstrap_options = "striped",
                             latex_options = c("striped", "hold_position"),
                             full_width = F)

FIT_V_TABLE %>% 
  knitr::kable(caption = 'G',
               booktabs=TRUE,
               align = c(rep('r', 5)),
               row.names = TRUE,
               escape = FALSE,
               #col.names = NULL,
               linesep = "") %>% 
   kableExtra::kable_styling(bootstrap_options = "striped",
                             latex_options = c("striped", "hold_position"),
                             full_width = F)
```

# Underliggende model

# Allokering af aktiver

# Diskussion

# Konklusion

## Problemer ved estimation

```{r script2, code = readLines("C:/Users/AKF/Documents/Matematik-Okonomi/5. Ar/2. Semester/Master-Thesis/Scripts/Speciale.R"), include=FALSE, cache=TRUE}
```

Middelværdi-varians optimering har vist sig meget sensitiv overfor den kvantitative størrelse af parametrene som indgår i vægtelsesberegningen for den relevante portefølje, dvs. forventede afkast, varianser, kovarianser. Som også er tilfældet i denne afhandling, er disse parametre estimeret via en tidsserie af afkast, men forventningen til disse estimater skal anskues skeptisk, i det de indeholder en væsentlig mængde usikkerhed.

Simuleringsforsøg har vist at porteføljer udvalgt på baggrund af Markowitz teorien med estimerede input har værre performance og er mindre efficient end en $\tfrac{1}{n}$ (ligevægtet) portefølje, [@Frankfurter1971]. Ligeledes viser [@Chopra1993] at det er afgørende i en porteføljeanalyse at estimere forventede afkast præcist, men forventede afkast er alt andet lige svært prædiktable, [@Merton1980]. Videnskabelige artikler har foreslået ændringer til de statistiske metoder som ligger bag estimaterne, heriblandt foreslår [@Jorion1986] at benytte en Bayesian estimator i stedet for det aritmetiske gennemsnit, se evt. også [@MacKinlay2000; @Garlappi2007; @Kan2007; @Tu2011].

I det følgende, vil vi lave et illustrativt simuleringseksempel, hvor vi tager udgangspunkt i tre risikobærende aktiver, hvis kvartalvise afkast alle er normalfordelt med de første to momenter som set i Tabel \@ref(tab:true). Afkastene er identisk fordelte i alle kvartaler. Det årlige forventede afkast er hhv. $9\%$, $15.76\%$ og $5.12\%$. Standardafvigelsen er hhv. $20.694\%$, $25.794\%$ og $17.320\%$. Vi antager der er ens positiv korrelation mellem hvert aktiv, på $0.5$. Derudover står investoren overfor et risikofrit aktiv med et kvartalvist afkast på $0.125\%$, og dermed et årligt risikofrit afkast på $0.5\%$. Disse er de korrekte parameterværdier, som givetvis er skjult information for investoren til en hvis grad. Investoren skal dermed estimere værdierne fra en tidsserie af observationer trukket fra den korrekte fordeling. Tre tidsserier af afkastsobservationer er blevet simuleret fra den fælles fordeling. Hver observation er hhv. beregnet som
\begin{align}
r_1 &= \mu_1 + \sigma_1\varepsilon_1\\
r_2 &= \mu_2 + \sigma_2\left(\rho_{1,2}\varepsilon_1 + \sqrt{1-\rho_{1,2}^2}\varepsilon_2\right)\\
r_3 &= \mu_3 + \sigma_3 \left( \rho_{1,3} \varepsilon_1+ \frac{ \rho_{2,3}-\rho_{1,2}\rho_{1,3} }{\sqrt{1-\rho_{1,2}^2}}\varepsilon_2+\sqrt{1-\rho_{1,3}^2 -\frac{\left(\rho_{2,3}-\rho_{1,2}\rho_{1,3}\right)^2}{1-\rho_{1,2}^2}}\varepsilon_3\right),
\end{align}

hvor $\varepsilon_i\sim N(0,1)$, for $i=1,2,3$. 

```{r sim-tids2, echo=FALSE, fig.align='center', fig.cap='i) Aktiv 1, ii) Aktiv 2, iii) Aktiv 3.', fig.width=18, fig.height=15, fig.pos='htbp!'}
par(mfrow=c(3,1))

plot(data_1[, 1],
     type = 'l',
     xaxs = "i",
     yaxs = "i",
     xlab = 'Kvartal',
     ylab = 'Afkast',
     main = 'i) Aktiv 1')

abline(h = mu_a, col = 'red', lty = 'dotted')
abline(h = mean(data_1[, 1]), col = 'magenta', lty = 'dashed')

plot(data_1[, 2],
     type = 'l',
     xaxs = "i",
     yaxs = "i",
     xlab = 'Kvartal',
     ylab = 'Afkast',
     main = 'ii) Aktiv 2')

abline(h = mu_b, col = 'red', lty = 'dotted')
abline(h = mean(data_1[, 3]), col = 'magenta', lty = 'dashed')

plot(data_1[, 3],
     type = 'l',
     xaxs = "i",
     yaxs = "i",
     xlab = 'Kvartal',
     ylab = 'Afkast',
     main = 'iii) Aktiv 3')

abline(h = mu_c, col = 'red', lty = 'dotted')
abline(h = mean(data_1[, 2]), col = 'magenta', lty = 'dashed')
```

```{r sim-tids, echo=FALSE, fig.align='center', fig.cap='i) Aktiv 1, ii) Aktiv 2, iii) Aktiv 3.', fig.width=18, fig.height=15, fig.pos='htbp!'}
data <- c(data_1[,1], data_1[,2], data_1[,3])
data <- data.frame(sim=data, type = c(rep(1, 200), rep(2,200), rep(3,200)))
data <- data.frame(data, index = seq(1,200))

ggplot(data, aes(index, sim)) +
geom_line() + facet_wrap(~type, scales = "free_y", ncol = 1)+
  expand_limits(x = 0, y = 0)+
  xlab(expression(italic("Indeks")))+
  ylab(expression(italic("Afkast")))+
  scale_x_continuous(expand = c(0,0))+
  scale_y_continuous(expand = c(0,0))+
  theme_classic()+
  theme(legend.position = "none",
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        panel.grid = element_blank(),
        plot.margin = margin(10, 14, 0, 0))
```



Hver tidsserie er baseret på $200$ observationer, svarende til en 50-årig periode med kvartalvise observationer. For hver tidsserie er de første to momenter estimeret ud fra de gængse statistiske metoder

```{r true, echo=FALSE}
data <- round(data.frame(Expect = return*100, Std = std*100, Corr = corr), digits = 3)
rownames(data) <- c('Aktiv 1', 'Aktiv 2', 'Aktiv 3')


data %>% 
  knitr::kable(caption = 'Gengivelse af de sande afkast.',
               booktabs=TRUE,
               align = c('r', 'r', 'r' ,'r', 'r'),
               row.names = T,
               col.names = NULL,
               linesep = "") %>% 
   kableExtra::kable_styling(bootstrap_options = "striped",
                             latex_options = c("striped", "hold_position"),
                             full_width = F) %>% 
  kableExtra::add_header_above(c(" ", "Forv. afkast" = 1, "Volatilitet" = 1, "Korrelationer" = 3))
```

```{r sim1, echo=FALSE}

data_1 <- round(data.frame(Expect = data_1_mean*100, Std = data_1_sd*100, Corr = data_1_cor), digits = 3)

rownames(data_1) <- c('Aktiv 1', 'Aktiv 2', 'Aktiv 3')

data_1 %>% 
  knitr::kable(caption = 'Gengivelse af første simulation af afkast.',
               booktabs=TRUE,
               align = c('r','r', 'r' ,'r', 'r'),
               row.names = T,
               col.names = NULL,
               linesep = "") %>% 
   kableExtra::kable_styling(bootstrap_options = "striped",
                             latex_options = c("striped", "hold_position"),
                             full_width = F) %>% 
  kableExtra::add_header_above(c(" ", "Forv. afkast" = 1, "Volatilitet" = 1, "Korrelationer" = 3))

```

```{r sim2, echo=FALSE}
data_2 <- round(data.frame(Expect = data_2_mean*100, Std = data_2_sd*100, Corr = data_2_cor), digits = 3)

rownames(data_2) <- c('Aktiv 1', 'Aktiv 2', 'Aktiv 3')

data_2 %>% 
  knitr::kable(caption = 'Gengivelse af anden simulation af afkast.',
               booktabs=TRUE,
               align = c('r','r', 'r' ,'r', 'r'),
               row.names = T,
               col.names = NULL,
               linesep = "") %>% 
   kableExtra::kable_styling(bootstrap_options = "striped",
                             latex_options = c("striped", "hold_position"),
                             full_width = F) %>% 
  kableExtra::add_header_above(c(" ", "Forv. afkast" = 1, "Volatilitet" = 1, "Korrelationer" = 3))
```

```{r sim3, echo=FALSE}
data_3 <- round(data.frame(Expect = data_3_mean*100, Std = data_3_sd*100, Corr = data_3_cor), digits = 3)

rownames(data_3) <- c('Aktiv 1', 'Aktiv 2', 'Aktiv 3')

data_3 %>% 
  knitr::kable(caption = 'Gengivelse af tredje simulation af afkast.',
               booktabs=TRUE,
               align = c('r','r', 'r' ,'r', 'r'),
               row.names = T,
               col.names = NULL,
               linesep = "") %>% 
   kableExtra::kable_styling(bootstrap_options = "striped",
                             latex_options = c("striped", "hold_position"),
                             full_width = F) %>% 
  kableExtra::add_header_above(c(" ", "Forv. afkast" = 1, "Volatilitet" = 1, "Korrelationer" = 3))

```


Disse tre sæt af estimerede parametre baseret på de tre tidsserier er blevet udvalgt til følgende illustrative formål. Se Tabel \@ref(tab:sim1), Tabel \@ref(tab:sim2) og Tabel \@ref(tab:sim3) for en sammenligning ift. de sande parametre. Ud fra de sande parametre samt de estimerede parametre fra de tre tidsserier er global minimum varians porteføljen, tangensporteføljen, den optimale portefølje for en *CRRA* investor med risikoaversions parameter lig hhv. $1$, $5$ og $10$, samt den optimale portefølje for en *CARA* investor med risikoaversions parameter lig hhv. $1$, $5$ og $10$.

Porteføljen for *CARA*-investoren er beregnet som
$$w^*=\frac{\mu_{\text{tan}}-r_0}{(aW_0)\sigma_{\text{tan}}^2},$$

hvor $w^*$ er den del af formuen som investoren skal investere i tangensporteføljen. Det estimerede forventede afkast, $\mu_{\text{tan}}$, og variansen af tangensporteføljen, $\sigma_{\text{tan}}^2$, er beregnet via de estimerede momenter af hvert aktiv. Delen som skal investeres i det risikofrie aktiv, bliver beregnet residuerligt som
$$w_{r_0}^*=1-w^*.$$

*CRRA* porteføljen er beregnet som i Sektion ??. Herudover er det sande forventede afkast og den sande standardafvigelse beregnet for hver portefølje, ved brug af de sande momenter introduceret ovenfor.

```{r sum-true, echo=FALSE}
options(knitr.kable.NA = '')
data <- round(data.frame(Min = c(port_true$gmv$weights,0,port_true$gmv$er*100, NA, port_true$gmv$sd*100, NA),
                         Tan = c(port_true$tan$weights,0,port_true$tan$er*100, NA, port_true$tan$sd*100, NA),
                         Crra_1 = c(port_true$crra_1$weights, port_true$crra_1$er*100, NA, port_true$crra_1$sd*100, NA),
                         Crra_4 = c(port_true$crra_4$weights, port_true$crra_4$er*100, NA, port_true$crra_4$sd*100, NA),
                         Crra_8 = c(port_true$crra_8$weights, port_true$crra_8$er*100, NA, port_true$crra_8$sd*100, NA),
                         cara_1 = c(port_true$cara_1$weights, port_true$cara_1$er*100, NA, port_true$cara_1$sd*100, NA),
                         cara_4 = c(port_true$cara_4$weights, port_true$cara_4$er*100, NA, port_true$cara_4$sd*100, NA),
                         cara_8 = c(port_true$cara_8$weights, port_true$cara_8$er*100, NA, port_true$cara_8$sd*100, NA)), digits = 3)

rownames(data) <- c('Aktiv 1', 'Aktiv 2', 'Aktiv 3', 'Risikofri', 'Forv. Afkast', 'Estimeret afkast', 'Volatilitet', 'Estimeret volatilitet')
colnames(data) <- c(" "," ","$\\gamma=1$", "$\\gamma=4$", "$\\gamma=8$", "$a=1$", "$a=4$", "$a=8$")

data %>% 
  knitr::kable(caption = 'Gengivelse af de beregnede porteføljer ved brug af de sande afkast.',
               booktabs=TRUE,
               align = c('r', 'r', 'r' ,'r', 'r'),
               row.names = T,
               escape = FALSE,
               #col.names = NULL,
               linesep = "") %>% 
   kableExtra::kable_styling(bootstrap_options = "striped",
                             latex_options = c("striped", "hold_position"),
                             full_width = F) %>% 
  kableExtra::add_header_above(c(" ", "GMV" = 1, "Tangens" = 1, "CRRA" = 3, "CARA" = 3), escape = F) %>% 
  kableExtra::row_spec(c(6, 8), italic = T)
```

```{r sum-1, echo=FALSE}
options(knitr.kable.NA = '')
data <- round(data.frame(Min = c(port_1$gmv$weights,
                                 0,
                                 sum(port_1$gmv$weights*return)*100,
                                 port_1$gmv$er*100,
                                 sqrt(t(port_1$gmv$weights) %*% cov %*% port_1$gmv$weights)*100,
                                 port_1$gmv$sd*100),
                         Tan = c(port_1$tan$weights,
                                 0,
                                 sum(port_1$tan$weights*return)*100,
                                 port_1$tan$er*100,
                                 sqrt(t(port_1$tan$weights) %*% cov %*% port_1$tan$weights)*100,
                                 port_1$tan$sd*100),
                         Crra_1 = c(port_1$crra_1$weights,
                                 sum(port_1$crra_1$weights*c(return, rf))*100,
                                 port_1$crra_1$er*100,
                                 sqrt(t(port_1$crra_1$weights[1:3]) %*% cov %*% port_1$crra_1$weights[1:3])*100,
                                 port_1$crra_1$sd*100),
                         Crra_4 = c(port_1$crra_4$weights,
                                 sum(port_1$crra_4$weights*c(return, rf))*100,
                                 port_1$crra_4$er*100,
                                 sqrt(t(port_1$crra_4$weights[1:3]) %*% cov %*% port_1$crra_4$weights[1:3])*100,
                                 port_1$crra_4$sd*100),
                         Crra_8 = c(port_1$crra_8$weights,
                                 sum(port_1$crra_8$weights*c(return, rf))*100,
                                 port_1$crra_8$er*100,
                                 sqrt(t(port_1$crra_8$weights[1:3]) %*% cov %*% port_1$crra_8$weights[1:3])*100,
                                 port_1$crra_8$sd*100),
                         cara_1 = c(port_1$cara_1$weights,
                                 sum(port_1$cara_1$weights*c(return, rf))*100,
                                 port_1$cara_1$er*100,
                                 sqrt(t(port_1$cara_1$weights[1:3]) %*% cov %*% port_1$cara_1$weights[1:3])*100,
                                 port_1$cara_1$sd*100),
                         cara_4 = c(port_1$cara_4$weights,
                                 sum(port_1$cara_4$weights*c(return, rf))*100,
                                 port_1$cara_4$er*100,
                                 sqrt(t(port_1$cara_4$weights[1:3]) %*% cov %*% port_1$cara_4$weights[1:3])*100,
                                 port_1$cara_4$sd*100),
                         cara_8 = c(port_1$cara_8$weights,
                                 sum(port_1$cara_8$weights*c(return, rf))*100,
                                 port_1$cara_8$er*100,
                                 sqrt(t(port_1$cara_8$weights[1:3]) %*% cov %*% port_1$cara_8$weights[1:3])*100,
                                 port_1$cara_8$sd*100)), digits = 3)

rownames(data) <- c('Aktiv 1', 'Aktiv 2', 'Aktiv 3', 'Risikofri', 'Forv. Afkast', 'Estimeret afkast', 'Volatilitet', 'Estimeret volatilitet')
colnames(data) <- c(" "," ","$\\gamma=1$", "$\\gamma=4$", "$\\gamma=8$", "$a=1$", "$a=4$", "$a=8$")

data %>% 
  knitr::kable(caption = 'Gengivelse af de beregnede porteføljer ved brug af de simulerede afkast, fra første simulering.',
               booktabs=TRUE,
               align = c('r', 'r', 'r' ,'r', 'r'),
               row.names = T,
               escape = FALSE,
               #col.names = NULL,
               linesep = "") %>% 
   kableExtra::kable_styling(bootstrap_options = "striped",
                             latex_options = c("striped", "hold_position"),
                             full_width = F) %>% 
  kableExtra::add_header_above(c(" ", "GMV" = 1, "Tangens" = 1, "CRRA" = 3, "CARA" = 3), escape = F) %>% 
  kableExtra::row_spec(c(6, 8), italic = T)
```

```{r sum-2, echo=FALSE}
options(knitr.kable.NA = '')
data <- round(data.frame(Min = c(port_2$gmv$weights,
                                 0,
                                 sum(port_2$gmv$weights*return)*100,
                                 port_2$gmv$er*100,
                                 sqrt(t(port_2$gmv$weights) %*% cov %*% port_2$gmv$weights)*100,
                                 port_2$gmv$sd*100),
                         Tan = c(port_2$tan$weights,
                                 0,
                                 sum(port_2$tan$weights*return)*100,
                                 port_2$tan$er*100,
                                 sqrt(t(port_2$tan$weights) %*% cov %*% port_2$tan$weights)*100,
                                 port_2$tan$sd*100),
                         Crra_1 = c(port_2$crra_1$weights,
                                 sum(port_2$crra_1$weights*c(return, rf))*100,
                                 port_2$crra_1$er*100,
                                 sqrt(t(port_2$crra_1$weights[1:3]) %*% cov %*% port_2$crra_1$weights[1:3])*100,
                                 port_2$crra_1$sd*100),
                         Crra_4 = c(port_2$crra_4$weights,
                                 sum(port_2$crra_4$weights*c(return, rf))*100,
                                 port_2$crra_4$er*100,
                                 sqrt(t(port_2$crra_4$weights[1:3]) %*% cov %*% port_2$crra_4$weights[1:3])*100,
                                 port_2$crra_4$sd*100),
                         Crra_8 = c(port_2$crra_8$weights,
                                 sum(port_2$crra_8$weights*c(return, rf))*100,
                                 port_2$crra_8$er*100,
                                 sqrt(t(port_2$crra_8$weights[1:3]) %*% cov %*% port_2$crra_8$weights[1:3])*100,
                                 port_2$crra_8$sd*100),
                         cara_1 = c(port_2$cara_1$weights,
                                 sum(port_2$cara_1$weights*c(return, rf))*100,
                                 port_2$cara_1$er*100,
                                 sqrt(t(port_2$cara_1$weights[1:3]) %*% cov %*% port_2$cara_1$weights[1:3])*100,
                                 port_2$cara_1$sd*100),
                         cara_4 = c(port_2$cara_4$weights,
                                 sum(port_2$cara_4$weights*c(return, rf))*100,
                                 port_2$cara_4$er*100,
                                 sqrt(t(port_2$cara_4$weights[1:3]) %*% cov %*% port_2$cara_4$weights[1:3])*100,
                                 port_2$cara_4$sd*100),
                         cara_8 = c(port_2$cara_8$weights,
                                 sum(port_2$cara_8$weights*c(return, rf))*100,
                                 port_2$cara_8$er*100,
                                 sqrt(t(port_2$cara_8$weights[1:3]) %*% cov %*% port_2$cara_8$weights[1:3])*100,
                                 port_2$cara_8$sd*100)), digits = 3)

rownames(data) <- c('Aktiv 1', 'Aktiv 2', 'Aktiv 3', 'Risikofri', 'Forv. Afkast', 'Estimeret afkast', 'Volatilitet', 'Estimeret volatilitet')
colnames(data) <- c(" "," ","$\\gamma=1$", "$\\gamma=4$", "$\\gamma=8$", "$a=1$", "$a=4$", "$a=8$")

data %>% 
  knitr::kable(caption = 'Gengivelse af de beregnede porteføljer ved brug af de simulerede afkast, fra anden simulering.',
               booktabs=TRUE,
               align = c('r', 'r', 'r' ,'r', 'r'),
               row.names = T,
               escape = FALSE,
               #col.names = NULL,
               linesep = "") %>% 
   kableExtra::kable_styling(bootstrap_options = "striped",
                             latex_options = c("striped", "hold_position"),
                             full_width = F) %>% 
  kableExtra::add_header_above(c(" ", "GMV" = 1, "Tangens" = 1, "CRRA" = 3, "CARA" = 3), escape = F) %>% 
  kableExtra::row_spec(c(6, 8), italic = T)
```

```{r sum-3, echo=FALSE}
options(knitr.kable.NA = '')
data <- round(data.frame(Min = c(port_3$gmv$weights,
                                 0,
                                 sum(port_3$gmv$weights*return)*100,
                                 port_3$gmv$er*100,
                                 sqrt(t(port_3$gmv$weights) %*% cov %*% port_3$gmv$weights)*100,
                                 port_3$gmv$sd*100),
                         Tan = c(port_3$tan$weights,
                                 0,
                                 sum(port_3$tan$weights*return)*100,
                                 port_3$tan$er*100,
                                 sqrt(t(port_3$tan$weights) %*% cov %*% port_3$tan$weights)*100,
                                 port_3$tan$sd*100),
                         Crra_1 = c(port_3$crra_1$weights,
                                 sum(port_3$crra_1$weights*c(return, rf))*100,
                                 port_3$crra_1$er*100,
                                 sqrt(t(port_3$crra_1$weights[1:3]) %*% cov %*% port_3$crra_1$weights[1:3])*100,
                                 port_3$crra_1$sd*100),
                         Crra_4 = c(port_3$crra_4$weights,
                                 sum(port_3$crra_4$weights*c(return, rf))*100,
                                 port_3$crra_4$er*100,
                                 sqrt(t(port_3$crra_4$weights[1:3]) %*% cov %*% port_3$crra_4$weights[1:3])*100,
                                 port_3$crra_4$sd*100),
                         Crra_8 = c(port_3$crra_8$weights,
                                 sum(port_3$crra_8$weights*c(return, rf))*100,
                                 port_3$crra_8$er*100,
                                 sqrt(t(port_3$crra_8$weights[1:3]) %*% cov %*% port_3$crra_8$weights[1:3])*100,
                                 port_3$crra_8$sd*100),
                         cara_1 = c(port_3$cara_1$weights,
                                 sum(port_3$cara_1$weights*c(return, rf))*100,
                                 port_3$cara_1$er*100,
                                 sqrt(t(port_3$cara_1$weights[1:3]) %*% cov %*% port_3$cara_1$weights[1:3])*100,
                                 port_3$cara_1$sd*100),
                         cara_4 = c(port_3$cara_4$weights,
                                 sum(port_3$cara_4$weights*c(return, rf))*100,
                                 port_3$cara_4$er*100,
                                 sqrt(t(port_3$cara_4$weights[1:3]) %*% cov %*% port_3$cara_4$weights[1:3])*100,
                                 port_3$cara_4$sd*100),
                         cara_8 = c(port_3$cara_8$weights,
                                 sum(port_3$cara_8$weights*c(return, rf))*100,
                                 port_3$cara_8$er*100,
                                 sqrt(t(port_3$cara_8$weights[1:3]) %*% cov %*% port_3$cara_8$weights[1:3])*100,
                                 port_3$cara_8$sd*100)), digits = 3)

rownames(data) <- c('Aktiv 1', 'Aktiv 2', 'Aktiv 3', 'Risikofri', 'Forv. Afkast', 'Estimeret afkast', 'Volatilitet', 'Estimeret volatilitet')
colnames(data) <- c(" "," ","$\\gamma=1$", "$\\gamma=4$", "$\\gamma=8$", "$a=1$", "$a=4$", "$a=8$")

data %>% 
  knitr::kable(caption = 'Gengivelse af de beregnede porteføljer ved brug af de simulerede afkast, fra tredje simulering.',
               booktabs=TRUE,
               align = c('r', 'r', 'r' ,'r', 'r'),
               row.names = T,
               escape = FALSE,
               #col.names = NULL,
               linesep = "") %>% 
   kableExtra::kable_styling(bootstrap_options = "striped",
                             latex_options = c("striped", "hold_position"),
                             full_width = F) %>% 
  kableExtra::add_header_above(c(" ", "GMV" = 1, "Tangens" = 1, "CRRA" = 3, "CARA" = 3), escape = F) %>% 
  kableExtra::row_spec(c(6, 8), italic = T)
```

Ved brug af de sande momenter, hælder minimum varians porteføljen mod Aktiv 3, med den relative laveste varians. Omtrent en tredjedel af porteføljen er eksponeret i Aktiv 1 og Aktiv 2 har den laveste vægtning givet dens høje relative varians. Tangensporteføljen består af to lange positioner i Aktiv 1 og Aktiv 2, tilsammen finansieret af en kort position i Aktiv 3, hvilket reflekterer rangeringen af aktiverne ift. deres *Sharpe Ratio*.
Fælles for alle tre simuleringer er, at de estimerede standard afvigelser og korrelationer er relativt tæt på de sande værdier. Som det til gengæld kan ses, er de forventede afkast langt sværere at estimere præcist. Hvilket er en essentiel faldgrube for middelværdi-varians porteføljeanalysen, da disse værdier er centrale for de udledte porteføljevægte.

For første simulering ses, at det forventede afkast på Aktiv 1 og specielt Aktiv 2 er overestimeret, mens det for Aktiv 3 er underestimeret. Dette medfører en ekstrem Tangensportefølje med en overvægtet lang position i Aktiv 2, en lang position i Aktiv 1 og en kort position i det underestimerede Aktiv 3. De sande forventede afkast af Tangensporteføljen og de optimale porteføljer for første simulering er signifikant lavere end det forventede afkast baseret på estimaterne. Omvendt ses at den sande volatilitet kun er en anelse højere end den estimerede volatilitet på porteføljerne. Som illustreret af den blå linje på Figur ??, er det sande bytteforhold mellem middelværdi og volatilitet på de estimerede porteføljer ikke langt fra porteføljerne baseret på de sande parametre.

For anden simulering er de estimerede forventede afkast alle underestimeret relativt meget, sammenlignet med første simuelering. Aktiv 2 er stadig mest attraktiv, men Aktiv 3 er nu mere attraktiv end Aktiv 1 grundet den højere *Sharpe Ratio*. Både den estimerede *CRRA*-portefølje, *CARA*-portefølje og Tangensportefølje har en høj positiv vægt på Aktiv 2 og meget lave positioner i Aktiv 1 og 3. Alle disse porteføljer har et langt højere sandt forventet afkast og en relativt højere sand volatilitet end de forventede afkast og volatilitet baseret på estimaterne, grundet de store estimationsfejl. Den magenta farvede linje på Figur ??, viser porteføljebyttetforholdene baseret på anden simulering.

Tredje simulering overestimerer Aktiv 1 samt 2 og underestimerer Aktiv 3. Rangeringen ift. *Sharpe Ratio* følger den sande rangering, men eksponeringen i Aktiv 1 og 2 er forhøjet, oftest sammensat med en kort position i Aktiv 3. De sande forventede afkast på porteføljerne er generelt noget lavere end de estimerede forventede afkast. Den sande volatilitet og den estimerede volatilitet ligger tæt op af hinanden. Den fjerde og sidste linje på Figur ?? viser bytteforholdet for porteføljerne baseret på tredje simulering.



```{r weight-exp2, echo=FALSE, fig.align='center', fig.cap='Global minimum varians portføljen, tangensporteføljen samt for CRRA- og CARA-porteføljen for hhv. $a=1$, $a=4$ og $a=8$, beregnet ud for hhv. de sande og simulerede afkast.', fig.pos='htbp!', fig.width=18, fig.asp=0.4}
par(mfrow=c(1,1))
plot(sort(sd),
     sort(r),
     type ='l',
     xlim=c(0,max(c(sd, sd_1, sd_2, sd_3))+0.0001),
     ylim=c(0,max(c(r, r_1, r_2, r_3))+0.0001),
     xaxs = "i",
     yaxs = "i",
     xlab = 'Volatilitet',
     ylab = 'Forventet afkast',
     main = 'Porteføljer.',
     lwd = 2
     )
points(sort(sd), sort(r), pch = 19)
lines(sort(sd_3), sort(r_3), lwd = 2, lty = 'dashed', col='red')
points(sort(sd_3), sort(r_3), pch = 19, col='red')
lines(sort(sd_2), sort(r_2), lwd = 2, lty = 'dotted', col='magenta')
points(sort(sd_2), sort(r_2), pch = 19, col='magenta')
lines(sort(sd_1), sort(r_1), lwd = 2, lty = 'dotdash', col='blue')
points(sort(sd_1), sort(r_1), pch = 19, col='blue')
```

```{r weight-exp, echo=FALSE, fig.align='center', fig.cap='Global minimum varians portføljen, tangensporteføljen samt for CRRA- og CARA-porteføljen for hhv. $a=1$, $a=4$ og $a=8$, beregnet ud for hhv. de sande og simulerede afkast.', fig.pos='htbp!', fig.width=18, fig.asp=0.4}
data <- data.frame(sd=c(sd, sd_1, sd_2, sd_3), r = c(r, r_1, r_2, r_3), type = c(rep(0, 8), rep(1, 8), rep(2, 8), rep(3, 8)))

ggplot(data, aes(sd, r))+
  geom_point(aes(color = type, group = type))+
  geom_line(aes(color = type, group = type))+
  expand_limits(x = 0, y = 0)+
  xlab(expression(italic("Volatilitet")))+
  ylab(expression(italic("Forventet Afkast")))+
  coord_cartesian(ylim = c(0, max(data$r)+0.05), xlim = c(0,max(data$sd)+0.05))+
  scale_x_continuous(expand = c(0,0))+
  scale_y_continuous(expand = c(0,0))+
  theme_classic()+
  theme(legend.position = "none",
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        panel.grid = element_blank(),
        plot.margin = margin(10, 14, 0, 0)
)
```

